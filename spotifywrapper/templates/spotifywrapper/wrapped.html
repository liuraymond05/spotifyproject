{% load static %}
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>My Spotify Wrapped</title>
    <link rel="stylesheet" href="{% static 'spotifywrapped/wrapped.css' %}">
</head>
<body>
    <div class="wrapper">
        <h1>My Spotify Wrapped</h1>
        <form method="get" action="{% url 'top_spotify_data' %}">
            <label for="time_range">Select Time Range:</label>
            <select name="time_range" id="time_range">
                <option value="short_term">Last 4 Weeks</option>
                <option value="medium_term">Last 6 Months</option>
                <option value="long_term">Last Year</option>
            </select>
            <button type="submit">Apply</button>
        </form>
        <h1>Spotify Wrapped for the last {% if selected_time_range == 'short_term' %}4 weeks{% elif selected_time_range == 'medium_term' %}6 months{% else %}year{% endif %}</h1>
         <div class="pic-container">


        <div id="silver-squiggle">
            <img src="../../static/spotifywrapped/silversquiggle.png" alt="Flower">
        </div>

        <div id="lavender">
            <img src="../../static/spotifywrapped/lavender.png" alt="Flower">
        </div>

    </div>
        <div class="carousel">
            <button class="arrow left" onclick="moveCarousel('left')">&#10094;</button>
            <div class="cards-container">
                <!-- First "Welcome" Slide -->
                <div class="card">
                    <h2>Welcome to Your Spotify Wrapped!</h2>
                    <p>Here's to your music taste {{ username }}!</p>

                </div>

                <!-- Additional slides with dynamic content -->
                <div class="card">
                    <h2>Top Genre</h2>
                    <p>{{ top_genre }}</p>
                </div>

                <div class="card">
    <h2>Top 3 Artists</h2>
                <!-- Save Wrapped Button -->
<button onclick="saveWrapped()">Save My Wrapped</button>
    <div class="artist-container">
        {% for artist in top_artists %}
            <div class="artist-card">
                <img src="{{ artist.image }}" alt="{{ artist.name }}" class="artist-image">
                <p class="artist-name">{{ artist.name }}</p>
            </div>
        {% endfor %}
    </div>
</div>


                <div class="card">
                    <h2>Total Minutes Listened</h2>
                    <p>{{ total_minutes_listened }} minutes</p>
                </div>

                <!-- Other slides with more dynamic content -->
                <div class="card">
                    <h2>Top Song</h2>
                    <p>{{ top_song }}</p>
                </div>

                <div class="card">
                    <h2>Top Playlist</h2>
                    <p>{{ top_playlist }}</p>
                </div>

                <div class="card">
                    <h2>Most Played Song</h2>
                    <p>{{ most_played_song }}</p>
                </div>

                <div class="card">
                    <h2>Top Artist of All Time</h2>
                    <p>{{ all_time_top_artist }}</p>
                </div>

                <div class="card">
                    <h2>Top Tracks</h2>
                    <ul>
                        {% for track in top_tracks %}
                            <li>{{ track.name }}</li>
                        {% endfor %}
                    </ul>
                </div>
            </div>
            <button class="arrow right" onclick="moveCarousel('right')">&#10095;</button>
        </div>
    </div>

    <script>

        let currentIndex = 0;

        function moveCarousel(direction) {
            const container = document.querySelector('.cards-container');
            const cards = document.querySelectorAll('.card');
            const totalCards = cards.length;

            if (direction === 'right') {
                currentIndex = (currentIndex + 1) % totalCards;
            } else if (direction === 'left') {
                currentIndex = (currentIndex - 1 + totalCards) % totalCards;
            }

            // Update the transform property to slide the carousel
            container.style.transform = `translateX(-${currentIndex * 320}px)`;  // 320px is the width of each card plus margin
        }

    </script>
</body>
</html>
